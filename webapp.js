// Generated by CoffeeScript 1.3.3
(function() {
  var $option, id, type, types, _i, _len;

  types = ['checking', 'noupdate', 'downloading', 'progress', 'cached', 'updateready', 'obsolete', 'error'];

  for (_i = 0, _len = types.length; _i < _len; _i++) {
    type = types[_i];
    window.applicationCache.addEventListener(type, function(event) {
      return console.log(event.type);
    });
  }

  id = null;

  $option = $('#option');

  window.applicationCache.addEventListener('downloading', function() {
    return id = setInterval((function() {
      return $('#option').toggleClass('btn-light');
    }), 500);
  });

  window.applicationCache.addEventListener('cached', function() {
    clearInterval(id);
    if ($option.hasClass('btn-light')) {
      return $option.removeClass('btn-light');
    }
  });

  window.applicationCache.addEventListener('updateready', function() {
    clearInterval(id);
    if (!$option.hasClass('btn-light')) {
      $option.addClass('btn-light');
    }
    return $('#version').html($('#version').html() + ' (new version available)');
  });

  window.applicationCache.addEventListener('error', function() {
    clearInterval(id);
    if (!$option.hasClass('btn-light')) {
      $option.addClass('btn-light');
    }
    return $('#version').html($('#version').html() + ' (cache error)');
  });

  app.initializeGoogleMaps();

  app.initializeDOM();

  $('#version').html('(C) 2012 ICHIKAWA, Yuji (New 3 Rs)<br>Maps ver. 1.2.5');

  window.onpagehide = function() {
    app.tracer.stop();
    app.saveMapStatus();
    return app.saveOtherStatus();
  };

  app.tracer.start();

}).call(this);
