// Generated by CoffeeScript 1.4.0
(function() {
  var $option, $version, BLINK_INTERVAL, STARTUP_TIME, VERSION, timerId, type, types, _i, _len;

  VERSION = '(C) 2012 ICHIKAWA, Yuji (New 3 Rs)<br>Maps ver. 1.2.13';

  BLINK_INTERVAL = 500;

  STARTUP_TIME = 3000;

  timerId = null;

  $option = $('#option');

  $version = $('#version');

  document.write('<div class="startup">\n    <div id="logo">RRR</div>\n</div>');

  window.applicationCache.addEventListener('downloading', function() {
    timerId = setInterval((function() {
      return $option.toggleClass('btn-light');
    }), BLINK_INTERVAL);
    return $version.html(VERSION + ' (downloading new version...)');
  });

  window.applicationCache.addEventListener('cached', function() {
    clearInterval(timerId);
    if ($option.hasClass('btn-light')) {
      return $option.removeClass('btn-light');
    }
  });

  window.applicationCache.addEventListener('updateready', function() {
    clearInterval(timerId);
    if (!$option.hasClass('btn-light')) {
      $option.addClass('btn-light');
    }
    return $version.html(VERSION + ' (new version available)');
  });

  window.applicationCache.addEventListener('error', function() {
    clearInterval(timerId);
    if (!$option.hasClass('btn-light')) {
      $option.addClass('btn-light');
    }
    return $version.html(VERSION + ' (cache error)');
  });

  types = ['checking', 'noupdate', 'downloading', 'progress', 'cached', 'updateready', 'obsolete', 'error'];

  for (_i = 0, _len = types.length; _i < _len; _i++) {
    type = types[_i];
    window.applicationCache.addEventListener(type, function(event) {
      return console.log(event.type);
    });
  }

  app.initializeGoogleMaps();

  $version.html(VERSION);

  app.initializeDOM();

  window.onpagehide = function() {
    app.tracer.stop();
    app.saveMapStatus();
    return app.saveOtherStatus();
  };

  setTimeout((function() {
    return $('.startup').on('webkitTransitionEnd', function() {
      return $('.startup').css('display', 'none');
    }).css('opacity', '0');
  }), STARTUP_TIME);

  app.tracer.start();

}).call(this);
